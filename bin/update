#!/bin/sh

if ! ping -q -w 1 -c 1 `ip r | grep default | cut -d ' ' -f 3` &> /dev/null
then
    echo "Not connected to the internet"
    exit 1
fi

update_layout="tmux select-layout -t update tiled"
tmux select-window -t update || tmux new-window -c ~ -n update
tmux send-keys yay Enter
for command in "nvim +PlugUpdate +PlugUpgrade +q +q" "rustup update" "flatpak update -y" "gem update" "tldr --update" "sh $ZSH/tools/upgrade.sh" 
do
    tmux split-window -d "$command; $update_layout"
    $update_layout
done
# do docker updates all in separate windows
for image in `docker images | tail -n +2 | cut -d ' ' -f 1`; do
    tmux split-window -d "docker pull $image; $update_layout"
    $update_layout
done
